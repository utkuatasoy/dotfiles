# Command: Commit (Conventional, No Emoji, One-Line)

Create conventional commits using **only Git** commands (`status`, `diff`, `add`, `commit`, `push`).
Commit messages are **single-line only** (no body/description), **no emojis**, and **never** include phrases like “generated by …”.

---

## Usage

```bash
/commit
```

Optional flags (recommended):

```bash
/commit --branch <target-branch> --push
/commit --max-files 25 --max-lines 800
/commit --interactive
```

---

## What This Command Does

### 1) Inspect working tree and staged changes (Git only)

Run:

```bash
git status --porcelain=v1
git diff --stat
git diff
git diff --staged --stat
git diff --staged
```

### 2) Decide whether to split into multiple commits (to avoid exclusion)

If changes are “too large” (example thresholds below), split into multiple smaller **logical** commits.

Default thresholds (customizable):

* **max-files**: 25 files changed
* **max-lines**: 800 total added + deleted lines (approx.)

Split if changes touch clearly separate areas (e.g., `ui/` + `api/` + `docs/`) or multiple concerns (e.g., `feat` + `refactor` + `fix`).

> Goal: “Related changes together” but not “everything in one giant commit”.

### 3) Stage changes in controlled parts

If nothing is staged, do **not** blindly run `git add .` when the diff is large.

**Hard rule (to prevent exclusion):**

* Never stage *all changed files* in one shot (`git add .`, `git add -A`, `git add --all`) when the working tree contains many files/lines.
* Always stage **only a subset** per commit (by hunk or by path), then commit, then continue with the next subset.

Stage by path (grouping by directory/module):

```bash
git add path/to/moduleA
git add path/to/moduleB
```

If you must stage “everything” for a **small** change set, do it only when you are safely below thresholds (e.g., files/lines), otherwise split first.

After staging each part, confirm:

```bash
git diff --staged --stat
git diff --staged
```

### 4) Generate a single-line conventional commit message (no emoji, no body)

Commit message must be **one line only**, format:

```text
<type>(optional-scope): <imperative subject>
```

Rules:

* No emoji.
* No second `-m` and no multiline body.
* Keep under ~72 characters.
* Imperative mood (e.g., “add”, “fix”, “remove”, “refactor”).

Create the commit:

```bash
git commit -m "<type>: <subject>"
```

### 5) Repeat for additional parts (if split)

For each commit part:

1. Stage the part
2. Review `git diff --staged`
3. Commit with a one-line conventional message
4. Continue until all intended changes are committed

### 6) Push to the requested branch (and main as required)

At the end, push using exactly:

```bash
git push -u origin main <branch>
```

Where `<branch>` is the target branch name (example: `feature/xyz`).

If `--branch` was not provided, use the current branch name:

```bash
git rev-parse --abbrev-ref HEAD
```

---

## Conventional Commit Types (No Emoji)

Use one of:

* `feat`: new feature
* `fix`: bug fix
* `docs`: documentation only
* `style`: formatting only (no logic)
* `refactor`: code change without `feat`/`fix`
* `perf`: performance improvement
* `test`: tests only
* `chore`: tooling/config/housekeeping
* `ci`: CI/CD related

---

## Splitting Guidance (Practical)

Split commits when any of these are true:

* Different concerns (e.g., UI change + backend change + infra)
* Mixed change types (e.g., `feat` + `refactor` + `fix`)
* Large change size risks automatic exclusion
* Reviewer clarity improves with separation

Suggested split strategy order:

1. `chore` / `ci` (config changes)
2. `refactor` (safe internal changes)
3. `feat` (new behavior)
4. `fix` (bug fixes)
5. `docs` / `test` (supporting changes)

If one file contains multiple concerns, use:

```bash
git add -p
```

---

## Examples (Single-Line Only)

* `feat: add user session timeout handling`
* `fix: prevent null pointer in payment validation`
* `refactor: simplify request parsing logic`
* `chore: update eslint configuration`

---

## Output Requirements (Strict)

When producing commit messages, output **only** the conventional commit **single line** per commit.

No emojis, no extra commentary, no descriptions, and no “generated by …” text.
